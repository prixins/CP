<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrices - owlingcode</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/js/all.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body>
    <header>
        <!-- ...existing header code... -->
    </header>

    <main class="container">
        <section id="topic-content">
            <div class="topic-navigation">
                <a href="combinatorics.html" class="nav-prev"><i class="fas fa-arrow-left"></i> Previous: Combinatorics</a>
                <a href="probability.html" class="nav-next">Next: Probability <i class="fas fa-arrow-right"></i></a>
            </div>
            
            <article class="topic">
                <h2>Matrices</h2>
                <div class="topic-metadata">
                    <span><i class="fas fa-book"></i> Advanced Topics</span>
                    <span><i class="fas fa-table"></i> Linear Algebra</span>
                </div>
                
                <div class="topic-intro">
                    <p>Matrix operations are fundamental for solving linear recurrences, graph problems, and optimization tasks. Understanding matrix multiplication and exponentiation opens up efficient solutions.</p>
                </div>
                
                <div class="topic-section">
                    <h3>What are Matrices?</h3>
                    <p>A matrix is a rectangular array of numbers arranged in rows and columns. In competitive programming, matrices are powerful tools for solving linear recurrences, graph problems, and optimization tasks efficiently.</p>
                    
                    <div class="info-box">
                        <h4>Key Matrix Concepts:</h4>
                        <ul>
                            <li><strong>Dimensions:</strong> An m×n matrix has m rows and n columns</li>
                            <li><strong>Square Matrix:</strong> Equal number of rows and columns</li>
                            <li><strong>Identity Matrix:</strong> Square matrix with 1s on diagonal, 0s elsewhere</li>
                            <li><strong>Zero Matrix:</strong> All elements are zero</li>
                        </ul>
                    </div>
                </div>
                
                <div class="topic-section">
                    <h3>Basic Matrix Operations</h3>
                    <p>Let's implement fundamental matrix operations:</p>
                    
                    <h4>Matrix Representation</h4>
                    <pre><code class="language-cpp">
typedef vector&lt;vector&lt;long long&gt;&gt; Matrix;

// Create a matrix with given dimensions
Matrix createMatrix(int rows, int cols, long long value = 0) {
    return Matrix(rows, vector&lt;long long&gt;(cols, value));
}

// Identity matrix
Matrix identity(int n) {
    Matrix result = createMatrix(n, n);
    for(int i = 0; i &lt; n; i++) {
        result[i][i] = 1;
    }
    return result;
}
                    </code></pre>
                    
                    <h4>Matrix Addition</h4>
                    <pre><code class="language-cpp">
Matrix add(Matrix A, Matrix B) {
    int rows = A.size(), cols = A[0].size();
    Matrix result = createMatrix(rows, cols);
    
    for(int i = 0; i &lt; rows; i++) {
        for(int j = 0; j &lt; cols; j++) {
            result[i][j] = A[i][j] + B[i][j];
        }
    }
    return result;
}
                    </code></pre>
                    
                    <h4>Matrix Multiplication</h4>
                    <pre><code class="language-cpp">
Matrix multiply(Matrix A, Matrix B, long long mod = 1e9 + 7) {
    int rows = A.size(), cols = B[0].size(), common = B.size();
    Matrix result = createMatrix(rows, cols);
    
    for(int i = 0; i &lt; rows; i++) {
        for(int j = 0; j &lt; cols; j++) {
            for(int k = 0; k &lt; common; k++) {
                result[i][j] = (result[i][j] + (A[i][k] * B[k][j]) % mod) % mod;
            }
        }
    }
    return result;
}
                    </code></pre>
                </div>
                
                <div class="topic-section">
                    <h3>Matrix Exponentiation</h3>
                    <p>Matrix exponentiation allows us to compute A^n efficiently in O(k³ log n) time, where k is the matrix dimension:</p>
                    
                    <pre><code class="language-cpp">
Matrix matrixPower(Matrix base, long long exp, long long mod = 1e9 + 7) {
    int n = base.size();
    Matrix result = identity(n);
    
    while(exp > 0) {
        if(exp & 1) {
            result = multiply(result, base, mod);
        }
        base = multiply(base, base, mod);
        exp >>= 1;
    }
    return result;
}
                    </code></pre>
                    
                    <div class="warning-box">
                        <h4><i class="fas fa-exclamation-triangle"></i> Important Notes</h4>
                        <ul>
                            <li>Always use modular arithmetic to prevent overflow</li>
                            <li>Matrix multiplication is not commutative: A×B ≠ B×A</li>
                            <li>Time complexity is O(k³) for k×k matrices</li>
                        </ul>
                    </div>
                </div>
                
                <div class="topic-section">
                    <h3>Linear Recurrence Relations</h3>
                    <p>Matrix exponentiation excels at solving linear recurrences like Fibonacci sequences:</p>
                    
                    <h4>Fibonacci with Matrix Exponentiation</h4>
                    <pre><code class="language-cpp">
long long fibonacci(long long n) {
    if(n <= 1) return n;
    
    // Transition matrix for F(n) = F(n-1) + F(n-2)
    Matrix transition = {{1, 1}, {1, 0}};
    Matrix result = matrixPower(transition, n - 1);
    
    // [F(n), F(n-1)] = [F(1), F(0)] * transition^(n-1)
    return result[0][0]; // F(n)
}
                    </code></pre>
                    
                    <h4>General Linear Recurrence</h4>
                    <p>For recurrence: f(n) = c₁×f(n-1) + c₂×f(n-2) + ... + cₖ×f(n-k)</p>
                    
                    <pre><code class="language-cpp">
// Solve f(n) = c[0]*f(n-1) + c[1]*f(n-2) + ... + c[k-1]*f(n-k)
long long linearRecurrence(vector&lt;long long&gt; coeffs, vector&lt;long long&gt; initial, long long n) {
    int k = coeffs.size();
    if(n &lt; k) return initial[n];
    
    // Create transition matrix
    Matrix transition = createMatrix(k, k);
    for(int i = 0; i &lt; k; i++) {
        transition[0][i] = coeffs[i];
    }
    for(int i = 1; i &lt; k; i++) {
        transition[i][i-1] = 1;
    }
    
    Matrix result = matrixPower(transition, n - k + 1);
    
    long long answer = 0;
    for(int i = 0; i &lt; k; i++) {
        answer = (answer + (result[0][i] * initial[k-1-i]) % MOD) % MOD;
    }
    return answer;
}
                    </code></pre>
                </div>
                
                <div class="topic-section">
                    <h3>Graph Applications</h3>
                    <p>Matrices are powerful for graph problems:</p>
                    
                    <h4>Counting Paths</h4>
                    <p>If A is the adjacency matrix, then A^k gives the number of paths of length k between vertices:</p>
                    
                    <pre><code class="language-cpp">
// Count paths of length k from vertex u to vertex v
long long countPaths(vector&lt;vector&lt;int&gt;&gt;&amp; adj, int u, int v, int k) {
    int n = adj.size();
    Matrix adjMatrix = createMatrix(n, n);
    
    // Convert adjacency list to matrix
    for(int i = 0; i &lt; n; i++) {
        for(int neighbor : adj[i]) {
            adjMatrix[i][neighbor] = 1;
        }
    }
    
    Matrix result = matrixPower(adjMatrix, k);
    return result[u][v];
}
                    </code></pre>
                    
                    <div class="tip-box">
                        <h4><i class="fas fa-lightbulb"></i> Matrix Applications</h4>
                        <ul>
                            <li><strong>Dynamic Programming:</strong> Optimize DP transitions</li>
                            <li><strong>Graph Theory:</strong> Count paths, detect cycles</li>
                            <li><strong>Number Theory:</strong> Fast exponentiation of recurrences</li>
                            <li><strong>Geometry:</strong> Transformations and rotations</li>
                        </ul>
                    </div>
                </div>
                
                <div class="topic-section">
                    <h3>Advanced Techniques</h3>
                    <p>Some advanced matrix operations for competitive programming:</p>
                    
                    <h4>Matrix Determinant</h4>
                    <pre><code class="language-cpp">
long long determinant(Matrix A, long long mod = 1e9 + 7) {
    int n = A.size();
    long long det = 1;
    
    for(int i = 0; i &lt; n; i++) {
        int pivot = -1;
        for(int j = i; j &lt; n; j++) {
            if(A[j][i] != 0) {
                pivot = j;
                break;
            }
        }
        
        if(pivot == -1) return 0; // Determinant is 0
        
        if(pivot != i) {
            swap(A[i], A[pivot]);
            det = (mod - det) % mod; // Change sign
        }
        
        det = (det * A[i][i]) % mod;
        
        long long inv = modInverse(A[i][i], mod);
        for(int j = i + 1; j &lt; n; j++) {
            long long factor = (A[j][i] * inv) % mod;
            for(int k = i; k &lt; n; k++) {
                A[j][k] = (A[j][k] - (factor * A[i][k]) % mod + mod) % mod;
            }
        }
    }
    
    return det;
}
                    </code></pre>
                </div>
            </article>
            
            <div class="practice-section">
                <h3 class="mt-4">CodeForces Challenge Problems</h3>
                <p>Practice matrix operations:</p>
                
                <div class="codeforces-problems">
                    <div class="problem-card">
                        <div class="difficulty hard">Hard</div>
                        <h4>Matrix Exponentiation</h4>
                        <p>Practice matrix exponentiation for fast computation.</p>
                        <div class="tags">
                            <span class="tag">Matrix</span>
                            <span class="tag">Exponentiation</span>
                        </div>
                        <a href="https://codeforces.com/problemset/problem/166/E" class="btn btn-secondary" target="_blank">Solve Problem</a>
                    </div>
                </div>
            </div>
            
            <div class="topic-navigation">
                <a href="combinatorics.html" class="nav-prev"><i class="fas fa-arrow-left"></i> Previous: Combinatorics</a>
                <a href="probability.html" class="nav-next">Next: Probability <i class="fas fa-arrow-right"></i></a>
            </div>
        </section>
    </main>

    <footer>
        <!-- ...existing footer code... -->
    </footer>

    <script src="../script.js"></script>
</body>
</html>
